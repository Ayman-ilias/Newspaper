{% extends 'base.html' %}
{% block head_title %}{{ news.title }}{% endblock %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        
        <div class="col-md-12">
            <div class="card m-2">
                <div class="card-body" style="background-color: rgb(216, 220, 220);">
                    <img class="img-fluid mx-auto d-block" src="{{ news.image.url }}" alt="">
                    <h1 class="card-title">{{ news.title }}
                        {% if avg_rating %}
    <!-- <p>Average rating: {{ avg_rating }}</p> -->
    {% if avg_rating|default:0 >= 1 and avg_rating|default:0 <= 1.5 %}
    <span>⭐</span>
{% endif %}

{% if avg_rating|default:0 > 1.5 and avg_rating|default:0 <= 2 %}
<span>⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 2 and avg_rating|default:0 <= 2.5 %}
<span>⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 2.5 and avg_rating|default:0 <= 3 %}
<span>⭐⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 3 and avg_rating|default:0 <= 3.5 %}
<span>⭐⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 3.5 and avg_rating|default:0 <= 4 %}
<span>⭐⭐⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 4 and avg_rating|default:0 <= 4.5 %}
<span>⭐⭐⭐⭐</span>
{% endif %}
{% if avg_rating|default:0 > 4.5 and avg_rating|default:0 <= 5 %}
<span>⭐⭐⭐⭐⭐</span>
{% endif %}
{% else %}
    <p>No ratings yet.</p>
{% endif %}
                    </h1>
                    <p class="card-text">{{ news.date }}</p>
                    <p><strong class="card-title">Reporter : {{ news.writter }}</strong></p>

                    <p class="card-text">   {{ news.content }}</p>
                    
                    
<br>
<strong>Related Article</strong>
<br>

{% if related_articles %}
    
{% for related_article in related_articles %}

                
            
                    <a href="{% url 'detail_news' related_article.id %}" style="text-decoration: none; color: brown;">
                        {{ related_article.title }}
                    </a>
                    <br>
                </strong>
               
          
{% endfor %}
{% else %}
<p>No related articles</p>
{% endif %}
<strong>Categories:</strong>
{% for category in news.category.all %}
    <button class="btn btn-danger btn-sm m-2" disabled>{{ category }}</button>
{% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container mt-4">
    <h3 class="text-center border">⭐⭐⭐⭐⭐Reviews⭐⭐⭐⭐⭐</h3>

    {% for comment in comments %}
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <p class="card-text">{{ comment.body }}</p>
                        <div class="d-flex align-items-center justify-content-center mb-2">
                            <span class="text-warning" style="background-color: aqua;">
                                {% if comment.rating == 1 %}
                                    <span>⭐</span>
                                {% elif comment.rating == 2 %}
                                    <span>⭐⭐</span>
                                {% elif comment.rating == 3 %}
                                    <span>⭐⭐⭐</span>
                                {% elif comment.rating == 4 %}
                                    <span>⭐⭐⭐⭐</span>
                                {% elif comment.rating == 5 %}
                                    <span>⭐⭐⭐⭐⭐</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ comment.user.username }}</strong>
                            </div>
                            <div class="text-muted">
                                <small>{{ comment.user.email }} | {{ comment.created_on }}</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
</div>



{% if request.user.is_authenticated %}

    <div class="d-flex justify-content-center align-items-center vh-100">
        <div class="card" style="width: 50%;">
            <div class="card-body">
                <h1 class="card-title text-center mb-4">Please Add Your Review</h1>
                <form method="post">
                    {% csrf_token %}
                    {{ comment_form | crispy }}
                    <button type="submit" class="btn btn-warning d-block mx-auto">Send</button>
                </form>
            </div>
        </div>
    </div>
{% else %}
<div class="text-center mt-5">
    <p class="lead">You need to be logged in to give a Rating</p>
</div>
{% endif %}
{% endblock %}
